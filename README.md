# KeyMouse - 键鼠替换工具

## 项目简介

KeyMouse 是一个专为 Windows 系统设计的键鼠替换和自动化工具。它允许用户自定义键盘和鼠标的行为，实现按键映射、宏定义以及模式切换等功能，旨在提升操作效率和个性化体验。

## 项目结构(更新较慢,请以实际仓库代码结构为准)

```
.gitignore
├── config.ini
├── config_loader.py
├── gui.py
├── main.py
├── main.spec
├── modeswitch.py
├── pyvenv.cfg
├── requirements.txt
├── tray_icon.py
├── utool.py
├── README.md
```



KeyMouse 的设计围绕以下几个核心理念展开：

1.  **模块化与可扩展性**：项目结构清晰，各功能模块（如模式切换、GUI 界面、系统托盘集成）职责分离，便于功能扩展和维护。
2.  **配置化与灵活性**：通过 INI/YAML 配置文件实现高度可定制性，用户可以根据自己的需求轻松调整按键映射和行为逻辑。
3.  **用户友好与直观**：提供图形用户界面（GUI）和系统托盘图标，方便用户进行配置管理和快速模式切换。
4.  **轻量级与高效**：底层采用 `pynput` 等库实现对键鼠事件的监听和控制，确保系统资源占用低，响应迅速。

## 主要功能

-   **模式切换**：根据预设的配置文件，快速切换不同的键鼠行为模式（例如，游戏模式、办公模式）。
-   **系统托盘集成**：在系统托盘提供便捷的入口，进行模式切换和程序退出等操作。
-   **图形化配置界面**：通过直观的 GUI 界面管理和编辑配置。

## 默认配置使用

项目默认提供了一套基础配置，开箱即用。以下是基于默认配置的简要使用说明：

以下是程序默认的键盘映射，所有操作仅在“鼠标控制模式”下生效，除非另有说明：

| 功能 (Function) | 默认按键 (Default Key) |
| :--- | :--- |
| **鼠标移动** | |
| 向上移动 | `i` |
| 向下移动 | `k` |
| 向左移动 | `j` |
| 向右移动 | `l` |
| **鼠标滚动** | |
| 向上滚动 | `comma` (逗号 ,) |
| 向下滚动 | `m` |
| **鼠标点击** | |
| 左键点击 | `semicolon` (分号 ;) |
| 右键点击 | `apostrophe` (单引号 ') |
| 中键点击 | `rshift` (右 Shift) |
| **高级功能** | |
| 粘滞左键 (切换) | `n` |
| **模式控制** | |
| 切换鼠标控制模式 | `<alt>+a` |
| 内部模式切换键 | `q` |
| 退出程序 (在控制模式下) | `esc` |

*   **退出程序**：
    *   **Esc 键**：在鼠标控制模式按下可安全退出程序,在普通模式下,为了防止用户的误操作所以不会直接退出。
**➡️ [点击此处阅读详细功能说明 (TUTORIAL.md)](TUTORIAL.md)**

## 注意:由于打包方法存在致命的方法,所以关于v0.0.6版本及其以后都是通过源码更新,Release发布程序暂时停止
### 1. 运行程序

双击 `KeyMouse.exe` 运行程序。程序启动后，会在系统托盘区显示一个图标。

> **重要提示**：
> 本项目以 Release 方式发布，主要通过 PyInstaller 打包为独立可执行文件。由于 Python 打包的特性，部分杀毒软件可能会误报病毒。请放心，本项目不包含任何恶意代码。如果遇到此类警告，请将其添加到杀毒软件的白名单中，或暂时关闭杀毒软件进行运行。

### 2. 系统托盘操作

右键点击系统托盘图标，可以进行以下操作：

-   **打开配置界面**：打开配置界面,可对于本程序极大多数操作进行配置。
-   **退出**：关闭 KeyMouse。

### 3. 配置文件

默认情况下，程序会加载 `config.ini` 作为主配置文件。你也可以通过系统托盘切换到其他配置文件，例如 `config_wasd.ini`。

-   `config.ini`：通用配置示例。
-   `config_wasd.ini`：WASD 键位相关的配置示例。

你可以直接编辑这些 `.ini` 文件来修改键鼠映射和宏定义。配置文件的具体格式和可配置项，请参考文件内部的注释或后续的详细配置指南。
但是强烈不建议直接通过配置文件来进行修改配置


## 源码安装与运行

# KeyMouse: 从源代码编译和运行指南
### **1. 环境要求 (Prerequisites)**

在开始之前，请确保您的系统已安装以下软件：

*   **Python**: **版本 3.9 或更高**。
    *   您可以从 [Python 官方网站](https://www.python.org/downloads/) 下载并安装。
    *   **极其重要**：在安装过程中，请务必勾选 **"Add Python to PATH"** 或 **“将 Python 添加到环境变量”** 选项。这是确保后续所有命令能正常工作的关键。

*   **Git** (推荐): 用于从代码仓库获取最新的源代码。
    *   您可以从 [Git 官方网站](https://git-scm.com/downloads) 下载。

*   **代码编辑器** (推荐): 例如 [Visual Studio Code](https://code.visualstudio.com/)，它能提供更好的代码阅读和编辑体验。

---

### **2. 安装与配置步骤**

#### **第一步：获取源代码**

打开您的命令行终端（CMD, PowerShell 或 Git Bash），执行以下命令将项目克隆到本地：

```bash
git clone https://github.com/ZeroPointSix/MouseReplaced.git
cd KeyMouse
```

如果您是直接下载的 ZIP 压缩包，请解压后在终端中 `cd` 进入该项目文件夹。

#### **第二步：创建并激活虚拟环境**

为了保持您系统 Python 环境的纯净，我们将为本项目创建一个独立的“沙箱”，也就是虚拟环境。

1.  **创建虚拟环境**:
    在项目根目录 (`KeyMouse` 文件夹) 下，运行以下命令。这会创建一个名为 `venv` 的文件夹，其中包含了项目所需的一个独立的Python环境。
    ```bash
    python -m venv venv
    ```

2.  **激活虚拟环境**:
    这是**每次运行前都必须执行**的步骤。
    *   **在 Windows 上**:
        ```powershell
        .\venv\Scripts\activate
        ```
    *   **在 macOS / Linux 上**:
        ```bash
        source venv/bin/activate
        ```
    成功激活后，您会看到命令行提示符的前面出现了 `(venv)` 的字样，表示您已进入“沙箱”环境。

#### **第三步：安装项目依赖**

在**已激活虚拟环境**的终端中，运行以下命令。它会自动读取 `requirements.txt` 文件，并将本项目所需的所有库（如 `pynput`, `pystray` 等）安装到您的虚拟环境中。

```bash
pip install -r requirements.txt
```

至此，您的编译环境已经全部配置完毕！

---

### **3. 运行程序**

您可以通过两种模式来运行 KeyMouse：

#### **模式一：运行主程序 (后台服务)**

这是最常用的模式。程序将在后台运行，并在系统托盘区显示一个图标。

在**已激活虚拟环境**的终端中，运行：

```bash
python main.py
```

您会看到终端输出一些启动信息，然后程序就会进入后台。您可以像使用普通软件一样，通过热键和托盘图标来与它交互。要关闭程序，请右键单击托盘图标并选择“退出”。

#### **模式二：打开图形设置界面 (GUI)**

如果您需要修改键位、速度等配置，可以运行此模式。

在**已激活虚拟amento**的终端中，运行：

```bash
python main.py --gui
```
或者使用简写：
```bash
python main.py -g
```

这会直接打开一个图形化的设置窗口。修改并保存设置后，关闭窗口即可。请注意，新的设置需要重启主程序才能生效。

---

### **4. 日常使用流程**

1.  打开一个新的终端。
2.  `cd` 到项目文件夹。
3.  激活虚拟环境 (`.\venv\Scripts\activate`)。
4.  运行主程序 (`python main.py`)。
5.  使用完毕后，通过托盘图标退出程序。

---

### **5. 故障排查 (Troubleshooting)**

*   **问题**: 终端提示 `ModuleNotFoundError: No module named 'pynput'` 或其他模块找不到。
    *   **原因**: 您很可能忘记了激活虚拟环境，或者忘记了安装依赖。
    *   **解决方案**:
        1.  请确保您已运行 `.\venv\Scripts\activate` 并且看到了 `(venv)` 提示符。
        2.  再次运行 `pip install -r requirements.txt` 以确保所有库都已安装。

*   **问题**: 终端提示 `'python' 不是内部或外部命令...` 或 `'python' is not recognized...`。
    *   **原因**: 您在安装 Python 时没有勾选 "Add Python to PATH"。
    *   **解决方案**: 请卸载 Python 后重新安装，并**务必**在安装界面的第一步就勾选该选项。

*   **问题**: 在某些游戏或专业软件中，KeyMouse 按键无效。
    *   **原因**: 目标程序以管理员权限运行，拦截了键盘事件。
    *   **解决方案**:
        1.  打开 `config.ini` 文件。
        2.  找到 `[Settings]` 下的 `run_as_admin` 选项，将其值修改为 `true`。
        3.  以**管理员身份**打开您的命令行终端，然后再次运行 `python main.py`。
