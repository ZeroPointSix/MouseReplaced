# 键盘鼠标控制工具

## 📖 项目简介

这是一个轻量级,适合Windows的Python工具，旨在当用户在高强度使用键盘的时候,可以通过键盘来避免使用鼠标对于思路的打断.
通过键盘实现对鼠标的全面控制，包括平滑移动、滚轮滚动以及按键长按功能。
项目专注于提供高度可配置的用户体验，目前鼠标控制的按键都支持自定义,但是由于模式切换等可能涉及到组合键的配置的时候,还没有完成,所以在配置的时候不要使用组合键调用。

## ✨ 主要功能

本项目已完成预期第一阶段的所有核心功能，提供以下特性：

*   **平滑与斜向鼠标移动**：通过独立的鼠标移动线程和按键状态管理，实现了鼠标的实时、平滑和斜向移动，解决了按键缓冲区堆积和滞后问题。
*   **系统级按键抑制**：利用 `pynput` 的事件抑制功能，确保在使用控制键（如 `I`、`J`、`K`、`L`）时，这些字符不会被意外输入到文本框中。
*   **稳定的模式切换**：通过全局标志变量和非阻塞的键盘监听器，实现了鼠标控制模式的流畅切换，避免了线程冲突问题。
*   **动态速度调节**：已实现通过 **左 Shift 键** 和 **Caps Lock 键** 动态降低鼠标移动速度的功能。
*   **平滑鼠标滚轮控制**：支持通过键盘按键实现鼠标滚轮的平滑向上和向下滚动。
*   **鼠标按键长按**：实现了鼠标左键、右键和中键的长按功能。
*   **可自定义键位**：支持通过外部配置文件自定义所有鼠标控制的键位映射。

## 🚀 快速开始

### 安装

1.  **克隆仓库**：
    ```bash
    git clone [你的GitHub仓库地址]
    cd [你的项目文件夹名称]
    ```
2.  **安装依赖**：
    ```bash
    pip install -r requirements.txt
    ```
    *(你需要创建一个 `requirements.txt` 文件，包含 `pynput` 和 `pywin32` 等依赖)*

### 运行程序

```bash
python main.py
```

程序启动后，您会在控制台看到提示信息，指导您如何使用。

## 🎮 默认键位操作

以下是程序默认的键盘映射，所有操作仅在“鼠标控制模式”下生效，除非另有说明：

*   **模式切换**：
    *   **Alt + A**：切换“普通模式”与“鼠标控制模式”。
    *   **Q 键**：在鼠标控制模式下按下，也会切换回“普通模式”。
*   **鼠标移动**：
    *   **I**：鼠标向上移动。
    *   **J**：鼠标向左移动。
    *   **K**：鼠标向下移动。
    *   **L**：鼠标向右移动。
*   **鼠标速度调节**：
    *   **左 Shift 键**：按住可降低鼠标移动速度。
    *   **Caps Lock 键**：按下可切换更大幅度地降低鼠标移动速度。
*   **鼠标按键 (长按)**：
    *   **; (分号键)**：模拟鼠标左键的按压与释放。
    *   **' (单引号键)**：模拟鼠标右键的按压与释放。
    *   **右 Shift 键**：模拟鼠标中键的按压与释放。
*   **鼠标滚轮**：
    *   **M 键**：鼠标滚轮向上滚动。
    *   **, (逗号键)**：鼠标滚轮向下滚动。
*   **退出程序**：
    *   **Esc 键**：随时按下可安全退出程序。

## ⚙️ 配置自定义键位

本项目支持通过外部配置文件自定义鼠标控制的键位：

1.  **配置文件**：请查找项目根目录下的 `config.yaml` 文件。
2.  **编辑方式**：使用任何文本编辑器打开 `config.yaml` 文件。您可以按照 YAML 格式修改对应的键位映射（例如，将 `MOUSE_CONTROL_KEYS` 中的虚拟键码替换为您想要的键）。
3.  **YAML 优点**：`config.yaml` 文件支持使用 `#` 进行注释，方便您理解和修改配置项。

## 📂 项目结构

```
[请在此处提供项目的目录结构，例如使用 tree 命令生成]
├── config.yaml          # 配置文件，用于自定义键位和参数
├── main.py              # 程序入口点，包含主逻辑
├── modules/             # 包含核心功能模块（如状态管理、鼠标控制、事件处理）
│   ├── mode_switch.py
│   ├── mouse_controller.py
│   └── event_handler.py
├── utils/               # 辅助工具函数
│   └── utool.py
└── README.md            # 项目说明文件
```
*(你可能需要根据实际的项目文件结构来填充这个部分)*

## 🔮 未来展望

我们计划在未来版本中实现以下功能和优化，以进一步提升用户体验和功能丰富度：

*   **图形用户界面 (GUI)**：开发一个直观的设置界面，让用户无需手动修改配置文件即可调整所有参数，包括键位、速度、模式等。
*   **更精细的参数微调**：提供更多的滑块和选项来控制鼠标移动速度、滚轮步长和延迟步长等参数。
*   **自动化工作流/宏**：引入录制和执行自定义鼠标键盘宏的功能，以实现重复性任务的自动化。
*   **更多指令模式**：扩展除鼠标控制外的其他功能模式，例如 Alt+M 触发的“指令模式”。
*   **多配置文件管理**：允许用户创建并保存多套配置方案（如“游戏模式”、“办公模式”），并通过托盘菜单或快捷键一键切换。
*   **标准化分发**：通过代码签名和创建安装包（例如使用 Inno Setup 或 NSIS），提升软件的专业性和用户信任度，减少杀毒软件误报。
*   **日志系统**：引入 `logging` 模块，替换现有的 `print` 语句，以便更好地追踪程序运行状态和调试问题。

## 📄 许可证

本项目遵循 MIT 许可证。详见 [LICENSE](LICENSE) 文件。

## 🤝 贡献

欢迎任何形式的贡献！如果您有任何功能建议、Bug 报告或代码改进，请随时提交 Issue 或 Pull Request。

---
*(你可以根据需要填充或修改 `[方括号]` 中的内容。)*
